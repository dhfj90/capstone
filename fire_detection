from ultralytics import YOLO
from IPython.display import display, Image
import yaml
import tensorflow as tf

model = YOLO("yolov8n.pt")

data = { 'train' : '/content/drive/MyDrive/capstone/train/images/',
         'val' : '/content/drive/MyDrive/capstone/val/images',
         'test' : '/content/drive/MyDrive/capstone/test/images',
         'names' : ['fire','smoke'],
         'nc' : 2}

with open('/content/drive/MyDrive/capstone/data.yaml', 'w') as f:
  yaml.dump(data, f)

with open('/content/drive/MyDrive/capstone/data.yaml', 'r') as f:
  fire_detect = yaml.safe_load(f)
  display(fire_detect)

model.train(data='/content/drive/MyDrive/capstone/data.yaml', epochs=100, imgsz=640)

results = model.predict(source='/content/drive/MyDrive/capstone/data/', save=True)

import locale
def getpreferredencoding(do_setlocale = True):
    return "UTF-8"
locale.getpreferredencoding = getpreferredencoding
